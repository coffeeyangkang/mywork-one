"use strict";define(["jquery","../index/checklogin","../index/cookie","../url"],function(q,e,t,N){for(var H,L,M=N.url+"/tianmao/php/",z=t.getCookie(),j=[],i=0,n=z.length;i<n;i++)H=z[i].split("="),L=H[0].match(/\d+/g),j[i]=L[0];q.ajax({type:"post",dataType:"json",url:M+"cart.php",data:{id:j,handle:"yes"}}).done(function(e){for(var t=[],i=0,n=z.length;i<n;i++)H=z[i].split("="),t[i]=H[1],L=H[0].match(/\d+/g),j[i]=L[0];var a,s=q(".goods-list");for(i=0;i<e.length;i++){var r=e[i].price*t[i];a='<div><input type="checkbox" name="select-all" class=\'single\' value="true">\n\t\t\t\t<img src='+e[i].smaurl+" style='width:40px;height:40px;'>\n\t\t\t\t<a>"+e[i].description1+"</a>\n\t\t\t\t<a></a>\n\t\t\t\t<a class='price'>"+e[i].price+"</a>\n\t\t\t\t<a><span class='car-minus'>-</span><input type='text' value='"+t[i]+"' class='number'><span class='car-plus'>+</span></a>\n\t\t\t\t<a class='totalprice'>"+r+"</a>\n\t\t\t\t<a><span class='move'>移入收藏夹</span><br><span class='delete'>删除</span></a></div>",q(a).appendTo(s.eq(0))}var c,o=q(".open>p>span"),p=q(".move"),l=q(".delete"),d=q(".car-minus"),u=q(".car-plus"),h=q(".number"),m=q(".totalprice"),x=q(".price"),v=q(".goods-list"),f=q("#all"),k=q(".single"),b=q(".total"),g=q(".totalprice");f.click(function(){var e=0;if(q(this)[0].checked){for(var t=0;t<k.size();t++)k.eq(t).prop("checked",q(this).prop("checked"));for(t=0;t<g.size();t++)e+=Number(g.eq(t).html());b.html(e.toFixed(2))}else{for(t=0;t<k.size();t++)k.eq(t).prop("checked",q(this).prop("checked"));b.html(0)}}),k.click(function(){var e=0;if(q(this).prop("checked"))for(var t=1;t<k.size();t++)k.eq(t).prop("checked")&&(e+=Number(m[t-1].innerHTML),b.html(e.toFixed(2)));else e=Number(b.html())-Number(m[q(this)[0].index].innerHTML),b.html(e.toFixed(2));for(t=0;t<k.size();t++)if(!k.eq(t).prop("checked")){f.prop("checked",!1),c=!1;break}t==k.size()&&(c=!0),c&&(f.prop("checked",!0),c=!0)});for(i=0;i<e.length;i++){p[i].index=e[i].goodid,l[p[i].subscript=i].index=i,l[i].subscript=e[i].goodid,u[d[i].index=i].index=i,k[i+1].index=i,p[i].onclick=function(){$ajax({async:"true",type:"post",url:M+"cart.php",dataType:"",data:{id:p[this.subscript].index,name:localStorage.getItem("logininfo"),num:h[this.subscript].value,url:e[this.subscript].smaurl,price:e[this.subscript].price,description:e[this.subscript].description1,handle:"insert"}})},l[i].onclick=function(){for(var e=document.cookie.split("; "),t=0,i=e.length;t<i;t++){var n=e[t].split("=");if(n[0]=="goodid"+this.subscript){var a=new Date;a.setDate(a.getDate()-1),document.cookie=n[0]+"='';expires="+a}}v[0].removeChild(p[q(this)[0].index].parentNode.parentNode)};for(var y=[],T=1;T<k.size();T++)y.push(k.eq(T).val());d[i].onclick=function(){if(sum=0,1<h[this.index].value&&(h[this.index].value=h[this.index].value-1,m[this.index].innerHTML=(h[this.index].value*x[this.index].innerText).toFixed(2)),k.eq(q(this)[0].index+1).prop("checked")){for(var e=1;e<k.size();e++)k.eq(e).prop("checked")&&(sum+=Number(m[e-1].innerHTML));b.html(sum)}},u[i].onclick=function(){if(sum=0,h[q(this)[0].index].value<100&&(h[q(this)[0].index].value=Number(h[q(this)[0].index].value)+1,m[q(this)[0].index].innerHTML=(h[q(this)[0].index].value*x[q(this)[0].index].innerText).toFixed(2)),k.eq(q(this)[0].index+1).prop("checked")){for(var e=1;e<k.size();e++)k.eq(e).prop("checked")&&(sum+=Number(m[e-1].innerHTML));b.html(sum)}},k[i+1].onclick=function(){var e=0;this.checked?(e+=Number(g[this.index].innerText),"0.00"!==b.innerHTML?b.innerHTML=Number(b.innerText)+e:b.innerHTML=e):b.innerHTML=Number(b.innerText)-Number(g[this.index].innerText)}}o[0].onclick=function(){q.ajax({type:"post",dataType:"json",url:N.url+"/tianmao/php/cart.php",data:{id:"",handle:"open"}}).done(function(e){console.log(e);var t,i,n=document.querySelector(".open"),a=!0,s=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done);a=!0){var p=c.value,l=document.createElement("div");i=(p.price*p.goodnum).toFixed(2),t='<input type="checkbox" name="select-all" value="true">\n\t\t\t\t\t\t<img src='+p.smaurl+" style='width:40px;height:40px;'>\n\t\t\t\t\t\t<a>"+p.description+"</a>\n\t\t\t\t\t\t<a></a>\n\t\t\t\t\t\t<a class='price'>"+p.price+"</a>\n\t\t\t\t\t\t<a><span class='car-minus'>-</span><input type='text' value='"+p.goodnum+"' class='number'><span class='car-plus'>+</span></a>\n\t\t\t\t\t\t<a class='totalprice'>"+i+"</a>\n\t\t\t\t\t\t<a><span class='move'>移入收藏夹</span><br><span class='delete'>删除</span></a>",l.innerHTML=t,n.appendChild(l)}}catch(e){s=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw r}}})}})});